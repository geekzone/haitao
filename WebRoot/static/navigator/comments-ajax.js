var i=0,got=-1,len=document.getElementsByTagName("script").length;while(i<=len&&got==-1){var js_url=document.getElementsByTagName("script")[i].src,got=js_url.indexOf("comments-ajax.js");i++;}var edit_mode="0",ajax_php_url=js_url.replace("-ajax.js","-ajax.php"),wp_url=js_url.substr(0,js_url.indexOf("wp-content")),pic_sb=wp_url+"wp-admin/images/wpspin_dark.gif",pic_no=wp_url+"wp-admin/images/no.png",pic_ys=wp_url+"wp-admin/images/yes.png",txt1='<div id="loading"><img src="'+pic_sb+'" style="vertical-align:middle;" alt=""/> 正在提交, 请稍候...</div>',txt2='<div id="error">#</div>',txt3='"><img src="'+pic_ys+'" style="vertical-align:middle;" alt=""/> 提交成功。',txt4='"><img src="'+pic_ys+'" style="vertical-align:middle;" alt=""/> 提交成功。若您的评论未显示，不是小编手快删帖，而是您的评论需审核，请谅解',edt1=', 刷新页面之前可以<a rel="nofollow" class="comment-reply-link" href="#edit" onclick=\'return addComment.moveForm("',edt2=")'>再编辑</a>",cancel_edit="取消编辑",edit,num=1,comm_array=[];comm_array.push("");jQuery(document).ready(function(c){$comments=c("#comments-title");$cancel=c("#cancel-comment-reply-link");cancel_text=$cancel.text();$submit=c("#commentform #submit");$submit.attr("disabled",false);c("#comment").after(txt1+txt2);c("#loading").hide();c("#error").hide();$body=(window.opera)?(document.compatMode=="CSS1Compat"?c("html"):c("body")):c("html,body");c("#commentform").submit(function(){c("#loading").slideDown();$submit.attr("disabled",true).fadeTo("slow",0.5);if(edit){c("#comment").after('<input type="text" name="edit_id" id="edit_id" value="'+edit+'" style="display:none;" />');}c.ajax({type:"POST",url:ajax_php_url,data:c(this).serialize(),dataType:"json",success:function(p){if(p.status=="ok"){cancle_vote();c("#loading").hide();comm_array.push(c("#comment").val());c("textarea").each(function(){this.value="";});var l=addComment,k=l.I("cancel-comment-reply-link"),j=l.I("wp-temp-form-div"),f=l.I(l.respondId),h=l.I("comment_post_ID").value,g=l.I("comment_parent").value;if(!edit&&$comments.length){n=parseInt($comments.text().match(/\d+/));$comments.text($comments.text().replace(n,n+1));}var m=c("#comments .commentTabBox").find(".commentTab:first");m.siblings().removeClass("currentTab");m.addClass("currentTab");c("#commentTabBlockNew").css("display","");c("#commentTabBlockHot").css("display","none");c("#li-comment-new").after(p.message);$body.animate({scrollTop:c("#li-comment-new").offset().top-140},900);c("#comments .commentTabBox").css("display","").find(".commentTab:first").css("display","");var o=c("#approved_status").val();if(o==1){ok_htm='\n<div id="success_'+num+txt3;}else{ok_htm='\n<div id="success_'+num+txt4;}if(edit_mode=="1"){div_=(document.body.innerHTML.indexOf("div-comment-")==-1)?"":((document.body.innerHTML.indexOf("li-comment-")==-1)?"div-":"");ok_htm=ok_htm.concat(edt1,div_,"comment-",g,'", "',g,'", "respond", "',h,'", ',num,edt2);}ok_htm+="</div>\n";c("#commentTabBlockNew .commentList").find(".commentRight:first").append(ok_htm);b();num++;edit="";c("*").remove("#edit_id");k.style.display="none";k.onclick=null;l.I("comment_parent").value="0";if(j&&f){j.parentNode.insertBefore(f,j);j.parentNode.removeChild(j);}}else{if(p.status=="no"){c("#loading").slideUp();c("#error").slideDown().html('<img src="'+pic_no+'" style="vertical-align:middle;" alt=""/> '+p.message);setTimeout(function(){$submit.attr("disabled",false).fadeTo("slow",1);c("#error").slideUp();},3000);}}}});return false;});addComment={moveForm:function(j,k,p,h,l){var u=this,f,o=u.I(j),g=u.I(p),s=u.I("cancel-comment-reply-link"),q=u.I("comment_parent"),r=u.I("comment_post_ID");if(edit){a();}if(q=="0"){l?(u.I("comment").value=comm_array[l],$new_sucs=c("#success_"+l),$new_sucs.hide(),edit=c("#li-comment-new").innerHTML.match(/(comment-)(\d+)/)[2],$new_comm=c("#li-comment-new"),$new_comm.hide(),$cancel.text(cancel_edit)):$cancel.text(cancel_text);}else{l?(u.I("comment").value=comm_array[l],$new_sucs=c("#success_"+l),$new_sucs.hide(),edit=u.I(".cdc-comment-new-"+q).innerHTML.match(/(comment-)(\d+)/)[2],$new_comm=c(".cdc-comment-new-"+q),$new_comm.hide(),$cancel.text(cancel_edit)):$cancel.text(cancel_text);}u.respondId=p;h=h||false;if(!u.I("wp-temp-form-div")){f=document.createElement("div");f.id="wp-temp-form-div";f.style.display="none";g.parentNode.insertBefore(f,g);}!o?(temp=u.I("wp-temp-form-div"),u.I("comment_parent").value="0",temp.parentNode.insertBefore(g,temp),temp.parentNode.removeChild(temp)):o.parentNode.insertBefore(g,o.nextSibling);$body.animate({scrollTop:c("#respond").offset().top-180},400);if(r&&h){r.value=h;}q.value=k;s.style.display="";s.onclick=function(){if(edit){a();}var w=addComment,v=w.I("wp-temp-form-div"),x=w.I(w.respondId);w.I("comment_parent").value="0";if(v&&x){v.parentNode.insertBefore(x,v);v.parentNode.removeChild(v);}this.style.display="none";this.onclick=null;return false;};try{u.I("comment").focus();}catch(m){}return false;},I:function(f){return document.getElementById(f);}};function a(){$new_comm.show();$new_sucs.show();c("textarea").each(function(){this.value="";});edit="";}var d=15,e=$submit.val();function b(){if(d>0){$submit.val(d);d--;setTimeout(b,1000);}else{$submit.val(e).attr("disabled",false).fadeTo("slow",1);d=15;}}});function grin(a){var d;a=""+a+"";if(document.getElementById("comment")&&document.getElementById("comment").type=="textarea"){d=document.getElementById("comment");}else{return false;}if(document.selection){d.focus();sel=document.selection.createRange();sel.text=a;d.focus();}else{if(d.selectionStart||d.selectionStart=="0"){var c=d.selectionStart;var b=d.selectionEnd;var e=b;d.value=d.value.substring(0,c)+a+d.value.substring(b,d.value.length);e+=a.length;d.focus();d.selectionStart=e;d.selectionEnd=e;}else{d.value+=a;d.focus();}}}